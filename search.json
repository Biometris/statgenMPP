[{"path":"/articles/QTLMapping_in_MultiParentPopulations.html","id":"the-statgenmpp-package","dir":"Articles","previous_headings":"","what":"The statgenMPP package","title":"QTL Mapping in Multi-Parent Populations","text":"statgenMPP package developed easy--use package QTL mapping multi-parent populations. package many ways visualizing inputs results. vignette describes detail perform IBD calculations QTL mapping using IBD probabilities mixed model framework, using LMMsolver R package. illustrated using three example data sets. first data set simulated NAM data set three parents, relatively small runs fast mainly used show functionality package. two data sets literature used show validity results package, first maize data set, dent panel EU-NAM maize project (Giraud et al. (2014)). second data set barley data set awn length described Liller et al. (2017).","code":""},{"path":[]},{"path":"/articles/QTLMapping_in_MultiParentPopulations.html","id":"ibd-calculations","dir":"Articles","previous_headings":"Theoretical background","what":"IBD Calculations","title":"QTL Mapping in Multi-Parent Populations","text":"calculations IBDs based Hidden Markov Models (HMM) inheritance vectors performed using statgenIBD R package. details theory see Lander Green (1987) Huang et al. (2011). also possible import IBD probabilities computed using RABBIT software (Zheng, Boer, Van Eeuwijk 2014, 2015, 2018). Using statgenIBD package, IBD probabilities can calculated many different types populations. See statgenIBD vignette overview populations. Using RABBIT complex populations MAGIC can also analyzed.","code":""},{"path":"/articles/QTLMapping_in_MultiParentPopulations.html","id":"qtl-mapping","dir":"Articles","previous_headings":"Theoretical background","what":"QTL Mapping","title":"QTL Mapping in Multi-Parent Populations","text":"follow methods described Li et al. (2021) QTL mapping. first step model without markers fitted: \\[y = X\\beta + \\varepsilon, \\quad \\varepsilon \\sim { }N\\left( {0, \\oplus_{k = 1}^{F} I_{{n_{k} }} \\sigma_{{\\varepsilon_{k} }}^{2} } \\right),\\] \\(y\\) vector phenotypes, \\(X\\) design matrix cross structure, \\(\\beta\\) vector fixed cross intercepts, residual term \\(\\varepsilon\\) cross-specific variance covariance structure \\(\\oplus_{k = 1}^{F} I_{{n_{k} \\sigma_{\\varepsilon_{k}}^{2}}}\\) \\(\\sigma_{\\varepsilon_{k}}^{2}\\) residual variance \\(k^{th}\\) cross family size \\(n_{k}\\), \\(F\\) number families. \\(F=1\\), example single biparental cross MAGIC population, variance covariance structure residual term homogeneous. evaluation points \\(q\\) map second model fitted: \\[y = X\\beta + M_{q} a_{q} + \\varepsilon, a_{q} \\sim { }N\\left( {0,I_{P} \\sigma_{q}^{2} } \\right), \\varepsilon \\sim { }N\\left( {0, \\oplus_{k = 1}^{F} I_{{n_{k} }} \\sigma_{{\\varepsilon_{k} }}^{2} } \\right),\\] \\(M_{q}\\) design matrix containing expected number parental alleles function IBD probabilities, \\(a_{q}\\) vector random parental effects variance covariance structure \\(I_{P} \\sigma_{q}^{2}\\), \\(\\sigma_{q}^{2}\\) genetic variance QTL effects P parents. Variance components putative QTL two models evaluated perform likelihood ratio test (LRT). p-value calculated using \\(\\chi^2\\) mixture approximation Likelihood Ratio Test. Multi-QTL Mapping (MQM) first steps . However first round scanning QTL highest \\(-log10(p)\\) value added cofactor model new round scanning done. repeated new QTLs found \\(-log10(p)\\) value predefined threshold, predefined maximum number cofactors added model. region specified width around cofactor new cofactors can detected. possible include polygenic \\(g\\) term models control background genetic information. models fitted become: \\[y = X\\beta + g + \\varepsilon, \\quad g \\sim { }N\\left( {0,K \\sigma_{g}^{2} } \\right), \\varepsilon \\sim { }N\\left( {0, \\oplus_{k = 1}^{F} I_{{n_{k} }} \\sigma_{{\\varepsilon_{k} }}^{2} } \\right),\\] \\[y = X\\beta + M_{q} a_{q} + g + \\varepsilon, a_{q} \\sim { }N\\left( {0,I_{P} \\sigma_{q}^{2} } \\right), g \\sim { }N\\left( {0,K \\sigma_{g}^{2} } \\right), \\varepsilon \\sim { }N\\left( {0, \\oplus_{k = 1}^{F} I_{{n_{k} }} \\sigma_{{\\varepsilon_{k} }}^{2} } \\right),\\] VCOV structure polygenic term \\(g\\) \\(K \\sigma_{g}^{2}\\) \\(\\sigma_{g}^{2}\\) variance polygenic effect, \\(K\\) kinship matrix. avoid proximal contamination chromosome specific kinship matrix used, computed using markers chromosomes. symmetric kinship matrix \\(K\\) can zero eigenvalues, leads problems solving mixed model equations. reason use spectral decomposition \\(K\\), \\(K=U D U^{-1}\\), use eigenvectors \\(U_+\\), corresponding positive eigenvalues diagonal matrix \\(D_+\\). Using transformation \\(g=Zu\\), \\(Z=U_+ D_+^{1/2}\\) obtain \\[y = X\\beta + Zu + \\varepsilon, \\quad u \\sim { }N\\left( {0,\\sigma_{u}^{2} } \\right), \\varepsilon \\sim { }N\\left( {0, \\oplus_{k = 1}^{F} I_{{n_{k} }} \\sigma_{{\\varepsilon_{k} }}^{2} } \\right),\\] \\[y = X\\beta + M_{q} a_{q} + Zu + \\varepsilon, a_{q} \\sim { }N\\left( {0,I_{P} \\sigma_{q}^{2} } \\right), g \\sim { }N\\left( {0,\\sigma_{u}^{2} } \\right), \\varepsilon \\sim { }N\\left( {0, \\oplus_{k = 1}^{F} I_{{n_{k} }} \\sigma_{{\\varepsilon_{k} }}^{2} } \\right),\\]","code":""},{"path":"/articles/QTLMapping_in_MultiParentPopulations.html","id":"example-simulated-data","dir":"Articles","previous_headings":"","what":"Example simulated data","title":"QTL Mapping in Multi-Parent Populations","text":"first example performing IBD calculations QTL mapping multi-parent population use relatively simple simulated data set. example contains simulated data two F4DH populations. population type F4DH cross two parents, followed 3 generations selfings, followed DH generation, see statgenIBD details. first population parents B, second parents C. first population consists 100 individuals, second 80 individuals. simple example NAM population, parent central parent. data simulated three QTLs, chromosome 1, 2, 3. necessary data population available package. QTL detection compute IBD probabilities grid positions along genome. can done using calcIBDMPP function statgenMPP package. perform IBD calculations marker file required populations. files tab-delimited file first column ID identifying genotype. following columns contain marker information. first rows contain parents used cross. example, file first cross, AxB, starts like : example markers M1_1 M1_4 segregating AxB cross, M1_2 M1_3 . map file also required. also tab-delimited file three columns, “marker name”, “chromosome” “position”. map file contain header identical crosses. Phenotypic data can added data.frame computing IBD probabilities. data.frame first column “genotype” columns numerical. simulated NAM population data.frame phenotypic data starts like : phenotypic data contains single trait, yield. performing IBD calculations specifying phenotypic data, phenotypic data combined computed IBD probabilities. , genotype specified ID column marker file(s) matched genotype genotype column data.frame phenotypic information. Phenotypic data crosses can either added single data.frame containing phenotypic data crosses, list data.frames containing phenotypic data single cross. calcIBDMPP IBD probabilities computed grid crosses separately combined single output object. value evalDist can used specify maximum distance (cM) two evaluation points grid. exact distance depends length chromosomes. output stored object class gDataMPP (genomic Data Multi Parent Populations) information map, markers, phenotypic data combined. summary function can get insight information. get idea population computed IBD probabilities can visualize results. First look structure pedigree population using plotType = \"pedigree\" get general idea design looks like.  Next look genetic map using plotType = \"genMap\". display genetic map population showing length chromosomes indicating positions IBD probabilities calculated. Optionally possible highlight one markers using highlight argument.  Finally visualize computed IBD probabilities across genome selected genotype using plotType = \"singleGeno\". plot show IBD probabilities parents positions genome selected genotype.  Using computed IBD probabilities can now actual QTL Mapping using selQTLMPP function. First perform SQM setting maxCofactors = 0. trait interest, yield, specified trait argument function. results SQM can plotted using plot function plotType = \"QTLProfile\".  Already SQM position three simulated QTLs quite clear. can get even better result using MQM. , use selQTLMPP function. don’t specify maxCofactors let algorithm determine number cofactors based threshold QTLwindow. long new markers found \\(-log10(p)\\) value threshold maximum number cofactors reached, new round scanning done. new round scanning marker highest \\(-log10(p)\\) value previous round added cofactors. Based profile plot SQM threshold set 3. QTLwindow specified therefore left default value 10cM. possible include polygenic term model control background genetic information. list chromosome specific kinship matrices can either computed selQTLMPP function specified user. former case enough specify computeKin = TRUE. kinship matrix computed averaging \\(Z Z^t\\) markers, \\(Z\\) genotype \\(\\times\\) parents matrix IBD probabilities marker. list precomputed chromosome specific kinship matrices can specified K. Note adding kinship matrix model increases computation time lot, especially large populations. advisable use parallel computing (see Parallel computing). Next can visualize results. First plot positions QTLs found genetic map. produce plot similar genetic map plot seen , now QTLs highlighted. plot can made specifying plotType = \"QTLRegion\"  SQM can also plot QTL profile. QTLs found highlighted profile red.  also possible plot size parental effects QTLs found. Positive effects parent trait indicated shades red, negative effects shades blue. stronger color, larger effect specific parent . plot can made using plotType = \"parEffs\".  Finally combined plot QTL profile parental can made. plot two previous plots plotted chromosomes positions aligned allow easily getting overview effect belongs QTL QTL profile. plot can made using plotType = \"QTLProfileExt\".  summary QTL-analyis gives short overview containing total number markers number QTLs found. Also QTL position chromosome shown well nearest marker original map, explained variance effects parents. output selQTLMPP p-Values effects markers can extracted. stored data.table within output object. example shows extract . output contain columns evalPos, chr pos name, chromosome number evaluation position columns pValue eff_par1, eff_par2, eff_par.. effects parents marker. also possible extract markers either QTLs within window one selected QTLs, specified calling selQTLMPP function. full results, information stored output data.table can extracted shown . columns data.table identical full results except additional column end, snpStatus, shows whether marker QTL within window QTL.","code":"## Specify files containing markers. # One file for each of the two crosses. markerFiles <- c(system.file(\"extdata/multipop\", \"AxB.txt\",                               package = \"statgenMPP\"),                  system.file(\"extdata/multipop\", \"AxC.txt\",                               package = \"statgenMPP\"))  ## Specify file containing map. # Both crosses use the same map file. mapFile <- system.file(\"extdata/multipop\", \"mapfile.txt\",                        package = \"statgenMPP\")  ## Read phenotypic data phenoDat <- read.delim(system.file(\"extdata/multipop\", \"AxBxCpheno.txt\",                                    package = \"statgenMPP\")) # Check contents. head(phenoDat) #>   genotype yield #> 1  AxB0001  9.89 #> 2  AxB0002  6.55 #> 3  AxB0003  7.90 #> 4  AxB0004  4.46 #> 5  AxB0005  5.21 #> 6  AxB0006  5.27  ## Perform IBD calculations.  ABCMPP <- calcIBDMPP(crossNames = c(\"AxB\", \"AxC\"),                        markerFiles = markerFiles,                      pheno = phenoDat,                      popType = \"F4DH\",                      mapFile = mapFile,                      evalDist = 5) ## Print summary summary(ABCMPP) #> map #>  Number of markers: 95  #>  Number of chromosomes: 5  #>  #> markers #>  Number of markers: 95  #>  Number of genotypes: 180  #>  Parents: A, B, C  #> pheno #>  Number of traits: 1  #>  Traitnames: yield  #>  Number of genotypes: 180  #>  #> crosses           #>  AxB:100   #>  AxC: 80 ## Plot structure of the pedigree. plot(ABCMPP, plotType = \"pedigree\") ## Plot genetic map. # Highlight marker on chromosome 3 at position 40. plot(ABCMPP, plotType = \"genMap\", highlight = \"EXT_3_40\") ## Plot IBD probabilities for genotype AxB0001. plot(ABCMPP, plotType = \"singleGeno\", genotype = \"AxB0001\") ## Perform Single-QTL Mapping. ABCSQM <- selQTLMPP(MPPobj = ABCMPP,                     trait = \"yield\",                     maxCofactors = 0) ## Plot QTL Profile for ABC SQM. plot(ABCSQM, plotType = \"QTLProfile\") ## Perform Multi-QTL Mapping. ABCMQM <- selQTLMPP(MPPobj = ABCMPP,                     trait = \"yield\",                     threshold = 3) ## Perform Multi-QTL Mapping. # Compute kinship matrices. ABCMQM_kin <- selQTLMPP(MPPobj = ABCMPP,                         trait = \"yield\",                         threshold = 3,                         computeKin = TRUE) ## Plot QTL Profile for ABC MQM. plot(ABCMQM, plotType = \"QTLRegion\") ## Plot QTL Profile for ABC MQM. plot(ABCMQM, plotType = \"QTLProfile\") ## Plot QTL Profile for ABC MQM. plot(ABCMQM, plotType = \"parEffs\") ## Plot QTL Profile for ABC MQM. plot(ABCMQM, plotType = \"QTLProfileExt\") ## Print summary summary(ABCMQM) #> Trait analysed: yield  #>  #> Data are available for 95 markers. #> Threshold: 3  #>  #> Number of QTLs: 3  #>  #>   evalPos chr pos mrkNear minlog10p varExpl  eff_A  eff_B  eff_C #>  EXT_1_25   1  25    M1_3     16.45   0.242 -1.417  0.859  0.558 #>  EXT_2_75   2  75    M2_8      8.59   0.217  0.833 -1.327  0.495 #>  EXT_3_65   3  65    M3_7     11.69   0.287  0.984  0.560 -1.544 ## Extract results of QTL mapping. ABCMQMres <- ABCMQM$GWAResult$yield head(ABCMQMres[, 1:8]) #> NULL ## Extract QTLs and markers within QTL windows. ABCMQMQTL <- ABCMQM$signSnp$yield head(ABCMQMQTL[, c(2:8, 10)]) #> NULL"},{"path":"/articles/QTLMapping_in_MultiParentPopulations.html","id":"example-maize","dir":"Articles","previous_headings":"","what":"Example maize","title":"QTL Mapping in Multi-Parent Populations","text":"second example use data maize NAM population described Giraud et al. (2014). NAM population consists 10 bi-parental doubled haploid (DH) crosses central parent F353. total population consists 841 individuals. Several traits measured four locations across Europe. calculated best linear unbiased estimations (BLUEs) traits using R package statgenSTA. example, perform QTL mapping mean value number days silking (“mean_DtSILK”) across locations. data population available package zipped format. simulated data, QTL detection first compute IBD probabilities grid positions along genome. look summary plots get overview pedigree computed probabilities.  Now can use computed IBD probabilities perform SQM. plot QTL profile SQM get idea reasonable values use threshold QTLwindow MQM next.  Based plot SQM threshold set 5 restrict bit number QTLs detected MQM. QTLwindow specified therefore left default value 10cM. look combined plot QTL Profile parental effects. give us direct insight QTLs found effects different parents crosses .","code":"## Define names of crosses. crosses <- paste0(\"F353x\", c(\"B73\", \"D06\", \"D09\", \"EC169\", \"F252\", \"F618\",                               \"Mo17\", \"UH250\", \"UH304\", \"W117\")) head(crosses) #> [1] \"F353xB73\"   \"F353xD06\"   \"F353xD09\"   \"F353xEC169\" \"F353xF252\"  \"F353xF618\"  ## Specify files containing crosses. ## Extract them in a temporary directory. tempDir <- tempdir() crossFiles <- unzip(system.file(\"extdata/maize/maize.zip\", package = \"statgenMPP\"),                      files = paste0(crosses, \".txt\"), exdir = tempDir)  ## Specify file containing map. mapFile <- unzip(system.file(\"extdata/maize/maize.zip\", package = \"statgenMPP\"),                   files = \"map.txt\", exdir = tempDir)  ## Read phenotypic data. phenoFile <- unzip(system.file(\"extdata/maize/maize.zip\", package = \"statgenMPP\"),                    files = \"EUmaizePheno.txt\", exdir = tempDir) phenoDat <- read.delim(phenoFile) head(phenoDat[, 1:5]) #>    genotype INR_DMY KWS_DMY Syngenta_DMY TUM_DMY #> 1 CFD02-003     182      NA          173      NA #> 2 CFD02-006     172     201          159     243 #> 3 CFD02-010     208     237          159     228 #> 4 CFD02-024     185     219          161     214 #> 5 CFD02-027     206     226          185     221 #> 6 CFD02-036     180     223          163     216  ## Perform IBD calculations.  maizeMPP <- calcIBDMPP(crossNames = crosses,                         markerFiles = crossFiles,                        pheno = phenoDat,                        popType = \"DH\",                        mapFile = mapFile,                        evalDist = 5) ## Print summary summary(maizeMPP) #> map #>  Number of markers: 262  #>  Number of chromosomes: 10  #>  #> markers #>  Number of markers: 262  #>  Number of genotypes: 841  #>  Parents: F353, B73, D06, D09, EC169, F252, F618, Mo17, UH250, UH304, W117  #> pheno #>  Number of traits: 30  #>  Traitnames: INR_DMY, KWS_DMY, Syngenta_DMY, TUM_DMY, ..., mean_NBPL  #>  Number of genotypes: 841  #>  #> crosses                  #>  F353xB73  : 64   #>  F353xD06  : 99   #>  F353xD09  :100   #>  F353xEC169: 66   #>  F353xF252 : 96   #>  F353xF618 :104   #>  F353xMo17 : 53   #>  F353xUH250: 94   #>  F353xUH304: 81   #>  F353xW117 : 84 ## Plot structure of the pedigree. plot(maizeMPP, plotType = \"pedigree\") ## Perform Single-QTL Mapping. maizeSQM <- selQTLMPP(MPPobj = maizeMPP,                       trait = \"mean_DtSILK\",                       maxCofactors = 0) ## Plot QTL Profile for maize SQM. plot(maizeSQM, plotType = \"QTLProfile\") ## Perform Multi-QTL Mapping. maizeMQM <- selQTLMPP(MPPobj = maizeMPP,                       trait = \"mean_DtSILK\",                       threshold = 5) ## Plot QTL Profile for maize MQM. plot(maizeMQM, plotType = \"QTLProfileExt\")"},{"path":"/articles/QTLMapping_in_MultiParentPopulations.html","id":"example-barley","dir":"Articles","previous_headings":"","what":"Example barley","title":"QTL Mapping in Multi-Parent Populations","text":"Instead performing IBD calculations directly package, also possible import IBD probabilities computed using RABBIT software (Zheng, Boer, Van Eeuwijk 2014, 2015, 2018). main advantage using RABBIT IBD calculations can handle complex pedigree populations therefore can also used cases population structure complex can computed using statgenIBD, e.g. maize NAM population described . example use barley population described Liller et al. (2017). MPP design consists 5 parents. Four wild parents crossed cultivar Morex backcrossed Morex . Individuals four families backcrosses crossed full diallel design, generated six F6 families five generations selfing. trait interest population awn length (“Awn_length”). maize NAM population, data population available zipped format package. RABBIT output can read using readRABBITMPP function statgenMPP. input standard RABBIT output summary file pedigree file needs provided RABBIT well. pedigree file optional input used plotting pedigree structure population. Without QTL mapping can still performed. calcIBDMPP phenotypic data provided data.frame. data.frame included package. maize example can summarize plot imported data get first idea content.  Performing SQM MQM imported RABBIT output works way IBD probabilities computed directly package. Since full scan take long precomputed results included package. large QTL chromosome 7. able clearly distinguish differences QTLs plotted separately.   QTLs found similar position, size effects described Liller et al. (2017). can also clearly seen comparing summary MQM table effects paper.","code":"## Specify files containing RABBIT output. ## Extract in a temporary directory. tempDir <- tempdir() inFile <- unzip(system.file(\"extdata/barley/barley_magicReconstruct.zip\",                              package = \"statgenMPP\"), exdir = tempDir)  ## Specify pedigree file. pedFile <- system.file(\"extdata/barley/barley_pedInfo.csv\",                        package = \"statgenMPP\")  ## Read phenotypic data. data(\"barleyPheno\")  ## read RABBIT output.  barleyMPP <- readRABBITMPP(infile = inFile,                            pedFile = pedFile,                            pheno = barleyPheno) ## Summary. summary(barleyMPP) #> map #>  Number of markers: 355  #>  Number of chromosomes: 7  #>  #> markers #>  Number of markers: 355  #>  Number of genotypes: 916  #>  Parents: Morex, HID4, HID64, HID369, HID382  #> pheno #>  Number of traits: 1  #>  Traitnames: Awn_length  #>  Number of genotypes: 916  #>  #> crosses          #>  50:149   #>  51:152   #>  52:157   #>  53:130   #>  54:167   #>  55:161 ## Plot structure of the pedigree. plot(barleyMPP, plotType = \"pedigree\") ## Perform Multi-QTL Mapping with threshold 4. barleyMQM <- selQTLMPP(MPPobj = barleyMPP,                        trait = \"Awn_length\",                        threshold = 4) ## Plot QTL Profile for barley MQM - chromosome 1-6. plot(barleyMQM, plotType = \"QTLProfileExt\", chr = 1:6) ## Plot QTL Profile for barley MQM - chromosome 7. plot(barleyMQM, plotType = \"QTLProfileExt\", chr = 7) ## Summary. summary(barleyMQM) #> Trait analysed: Awn_length  #>  #> Data are available for 355 markers. #> Threshold: 4  #>  #> Number of QTLs: 12  #>  #>  evalPos chr    pos mrkNear minlog10p varExpl eff_Morex eff_HID4 eff_HID64 eff_HID369 #>   2_1053   1  47.06  2_1053     10.05  0.0212   -4.4815     1.72     3.563     -1.425 #>   2_1187   2  27.21  2_1187      4.86  0.0121    3.7109    -1.01    -0.200     -0.815 #>   1_1522   2  46.06  1_1522      4.73  0.0459   -0.0572     7.25    -2.554     -5.226 #>   2_0340   2  68.99  2_0340      6.14  0.0208   -3.8297     1.96    -0.811     -0.437 #>   1_1501   3  42.17  1_1501     13.42  0.0526    4.6614    -2.88    -1.654     -5.951 #>   1_1070   4  51.72  1_1070      5.83  0.0554   -4.7880    -1.89     8.331      0.844 #>   1_0611   4 102.75  1_0611      4.05  0.0299   -0.9099    -2.47     3.531     -4.200 #>   2_0645   5  56.84  2_0645      6.86  0.0268    5.2156    -2.56    -1.824      1.227 #>   1_0094   5  94.26  1_0094     14.48  0.0939   -8.4484     1.70    -3.081      9.928 #>   1_0120   6   1.67  1_0120      4.41  0.0372    2.6349    -1.39    -5.899      1.992 #>   2_0687   6  88.03  2_0687      5.70  0.0344   -4.3277     2.90     3.666      1.144 #>   1_1012   7 121.04  1_1012     65.39  0.2648   11.3779     5.77    -9.658      7.651 #>  eff_HID382 #>       0.629 #>      -1.681 #>       0.583 #>       3.119 #>       5.827 #>      -2.502 #>       4.050 #>      -2.061 #>      -0.102 #>       2.665 #>      -3.387 #>     -15.136"},{"path":"/articles/QTLMapping_in_MultiParentPopulations.html","id":"parCom","dir":"Articles","previous_headings":"","what":"Parallel computing","title":"QTL Mapping in Multi-Parent Populations","text":"improve performance, possible use parallel computing perform QTL mapping. , parallel back-end specified user, e.g. using registerDoParallel doParallel package (see example ). Besides, selQTLMPP function argument parallel set TRUE. settings computations done parallel per chromosome. course, doesn’t effect output. MQM gives exactly results non-parallel one described earlier vignette.","code":"## Register parallel back-end with 2 cores. doParallel::registerDoParallel(cores = 2)  ## Perform Multi-QTL Mapping. ABCMQM_Par <- selQTLMPP(MPPobj = ABCMPP,                         trait = \"yield\",                         threshold = 3,                         parallel = TRUE)"},{"path":"/articles/QTLMapping_in_MultiParentPopulations.html","id":"summary","dir":"Articles","previous_headings":"","what":"Summary","title":"QTL Mapping in Multi-Parent Populations","text":"properties using statgenMPP QTL mapping MPPs shown several examples demonstrated . easy--use R package, integrating HMM method IBD calculation mixed-model approach QTL mapping, provides us general framework estimate multi-allelic QTL effects terms parent origins.","code":""},{"path":"/articles/QTLMapping_in_MultiParentPopulations.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"QTL Mapping in Multi-Parent Populations","text":"Giraud, Héloı̈se, Christina Lehermeier, Eva Bauer, Matthieu Falque, Vincent Segura, Cyril Bauland, Christian Camisan, et al. 2014. “Linkage Disequilibrium Linkage Analysis Multiline Crosses Reveals Different Multiallelic QTL Hybrid Performance Flint Dent Heterotic Groups Maize.” Genetics 198 (4): 1717–34. https://doi.org/10.1534/genetics.114.169367. Huang, Xueqing, Maria-João Paulo, Martin Boer, Sigi Effgen, Paul Keizer, Maarten Koornneef, Fred Van Eeuwijk. 2011. “Analysis natural allelic variation Arabidopsis using multiparent recombinant inbred line population.” https://doi.org/10.1073/pnas.1100465108. Lander, Eric S., Philip Green. 1987. “Construction multilocus genetic linkage maps humans (restriction fragment length polymorphism/EM algorithm/genetic reconstruction algorithm/human genetics/plant genetics).” Proc. Nati. Acad. Sci. USA 84 (2): 2363–7. https://www.jstor.org/stable/29713. Li, Wenhao, Martin P. Boer, Chaozhi Zheng, Ronny V. L. Joosen, Fred . Van Eeuwijk. 2021. “IBD-based mixed model approach QTL mapping multiparental populations.” Theor. Appl. Genet. 2021 1 (August): 1–18. https://doi.org/10.1007/S00122-021-03919-7. Liller, Corinna B, Agatha Walla, Martin P Boer, Pete Hedley, Malcolm Macaulay, Sieglinde Effgen, Maria von Korff, G Wilma van Esse, Maarten Koornneef. 2017. “Fine Mapping Major QTL Awn Length Barley Using Multiparent Mapping Population.” Züchter Genet. Breed. Res. 130 (2): 269–81. https://doi.org/10.1007/s00122-016-2807-y. Zheng, Chaozhi, Martin P Boer, Fred Van Eeuwijk. 2015. “Reconstruction Genome Ancestry Blocks Multiparental Populations.” Genetics 200 (4): 1073–87. https://doi.org/10.1534/GENETICS.115.177873. ———. 2018. “Recursive Algorithms Modeling Genomic Ancestral Origins Fixed Pedigree.” G3 Genes|Genomes|Genetics 8 (10): 3231–45. https://doi.org/10.1534/G3.118.200340. ———. 2014. “General Modeling Framework Genome Ancestral Origins Multiparental Populations.” Genetics 198 (1): 87–101. https://doi.org/10.1534/genetics.114.163006.","code":""},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Wenhao Li. Author. Martin Boer. Author. Bart-Jan van Rossum. Author, maintainer. Fred van Eeuwijk. Contributor.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Li W, Boer M, van Rossum B (2022). statgenMPP: QTL Mapping Multi Parent Populations. R package version 1.0.1.","code":"@Manual{,   title = {statgenMPP: QTL Mapping for Multi Parent Populations},   author = {Wenhao Li and Martin Boer and Bart-Jan {van Rossum}},   year = {2022},   note = {R package version 1.0.1}, }"},{"path":"/index.html","id":"statgenmpp","dir":"","previous_headings":"","what":"An R package for QTL mapping in multi parent populations","title":"An R package for QTL mapping in multi parent populations","text":"statgenMPP package developed easy--use package QTL mapping multi-parent populations. package many ways visualizing inputs results. First Identity Descent (IBD) probabilities computed using Hidden Markov Models. probabilities used mixed model approach QTL Mapping described Li et al. 2021. Install CRAN: Install latest development version GitHub (requires remotes package):","code":"install.packages(\"statgenMPP\") remotes::install_github(\"Biometris/statgenMPP\", ref = \"develop\", dependencies = TRUE)"},{"path":"/reference/barleyMQM.html","id":null,"dir":"Reference","previous_headings":"","what":"Pre-computed MQM output barley — barleyMQM","title":"Pre-computed MQM output barley — barleyMQM","text":"Pre-computed MQM output barley data used vignette.","code":""},{"path":"/reference/barleyMQM.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pre-computed MQM output barley — barleyMQM","text":"","code":"barleyMQM"},{"path":"/reference/barleyMQM.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Pre-computed MQM output barley — barleyMQM","text":"object class QTLMPP (inherits GWAS) length 5.","code":""},{"path":"/reference/barleyPheno.html","id":null,"dir":"Reference","previous_headings":"","what":"Phenotypic data for awn length in barley — barleyPheno","title":"Phenotypic data for awn length in barley — barleyPheno","text":"Phenotypic data awn length barley","code":""},{"path":"/reference/barleyPheno.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Phenotypic data for awn length in barley — barleyPheno","text":"","code":"barleyPheno"},{"path":"/reference/barleyPheno.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Phenotypic data for awn length in barley — barleyPheno","text":"data.frame 916 rows 3 columns. genotype Genotype Awn_length Awn_length mm. cross cross genotype belongs .","code":""},{"path":"/reference/barleyPheno.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Phenotypic data for awn length in barley — barleyPheno","text":"Fine mapping major QTL awn length barley using multiparent mapping population. Liller CB, Walla , Boer MP, Hedley P, Macaulay M, Effgen S, von Korff M, van Esse GW, Koornneef M. Theor Appl Genet. 2017 Feb;130(2):269-281. doi:10.1007/s00122-016-2807-y .","code":""},{"path":"/reference/calcDistance.html","id":null,"dir":"Reference","previous_headings":"","what":"cofactor selection based on the QTL windowsize — calcDistance","title":"cofactor selection based on the QTL windowsize — calcDistance","text":"cofactor selection based QTL windowsize","code":""},{"path":"/reference/calcDistance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cofactor selection based on the QTL windowsize — calcDistance","text":"","code":"calcDistance(map, m1, m2)"},{"path":"/reference/calcIBDmpp.html","id":null,"dir":"Reference","previous_headings":"","what":"IBD calculation for multi parental populations — calcIBDMPP","title":"IBD calculation for multi parental populations — calcIBDMPP","text":"IBD calculation multi parental populations. Per cross IBD probabilities calculated using calcIBD statgenIBD package. probabilities combined optional phenotypic data stored single object class gDataMPP.","code":""},{"path":"/reference/calcIBDmpp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"IBD calculation for multi parental populations — calcIBDMPP","text":"","code":"calcIBDMPP(   crossNames,   markerFiles,   pheno,   popType,   mapFile,   evalDist,   grid = TRUE,   verbose = FALSE )"},{"path":"/reference/calcIBDmpp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"IBD calculation for multi parental populations — calcIBDMPP","text":"crossNames character vector, names crosses. markerFiles character vector indicating locations files genotypic information populations. files tab-delimited format header containing marker names. pheno data.frame list data.frames phenotypic data, genotypes first column genotype traits following columns. trait columns numerical columns . list data.frames can used replications, .e. different trials. popType character string indicating type population. One DH, Fx, FxDH, BCx, BCxDH, BC1Sx, BC1SxDH, C3, C3DH, C3Sx, C3SxDH, C4, C4DH, C4Sx, C4SxDH (see Details). mapFile character string indicating location map file population. file tab-delimited format. consist exactly three columns, marker, chromosome position. header. positions file centimorgan. evalDist numeric value, maximum distance cM evaluation points. grid extra markers added assure maximum distince evalDist grid (TRUE) marker existing marker positions (FALSE). verbose progress printed?","code":""},{"path":"/reference/calcIBDmpp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"IBD calculation for multi parental populations — calcIBDMPP","text":"object class gDataMPP following components: map data.frame containing map data. Map sorted chromosome position. markers 3D matrix containing IBD probabilities. pheno data.frame list data.frames containing phenotypic data. kinship kinship matrix. covar data.frame extra covariates (including name cross).","code":""},{"path":"/reference/calcIBDmpp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"IBD calculation for multi parental populations — calcIBDMPP","text":"IBD probabilities can calculated many different types populations. following table supported populations listed. Note value x population types variable, maximum value depicted last column.","code":""},{"path":"/reference/calcIBDmpp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"IBD calculation for multi parental populations — calcIBDMPP","text":"","code":"## Read phenotypic data. pheno <- read.delim(system.file(\"extdata/multipop\", \"AxBxCpheno.txt\",                                package = \"statgenMPP\")) ## Rename first column to genotype. colnames(pheno)[1] <- \"genotype\"   ## Compute IBD probabilities for simulated population - AxB, AxC. ABC <- calcIBDMPP(crossNames = c(\"AxB\", \"AxC\"),                   markerFiles = c(system.file(\"extdata/multipop\", \"AxB.txt\",                                               package = \"statgenMPP\"),                                   system.file(\"extdata/multipop\", \"AxC.txt\",                                               package = \"statgenMPP\")),                   pheno = pheno,                   popType = \"F4DH\",                   mapFile = system.file(\"extdata/multipop\", \"mapfile.txt\",                                         package = \"statgenMPP\"),                   evalDist = 5)  summary(ABC) #> map #> \tNumber of markers: 95  #> \tNumber of chromosomes: 5  #>  #> markers #> \tNumber of markers: 95  #> \tNumber of genotypes: 180  #> \tParents: A, B, C  #> pheno #> \tNumber of traits: 1  #> \tTraitnames: yield  #> \tNumber of genotypes: 180  #>  #> crosses           #>  AxB:100   #>  AxC: 80"},{"path":"/reference/createGDataMPP.html","id":null,"dir":"Reference","previous_headings":"","what":"Create an object of class gDataMPP — createGDataMPP","title":"Create an object of class gDataMPP — createGDataMPP","text":"Function creating object class gDataMPP object class IBDprob (computed imported using statgenIBD) phenotypic data.","code":""},{"path":"/reference/createGDataMPP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create an object of class gDataMPP — createGDataMPP","text":"","code":"createGDataMPP(IBDprob, pheno)"},{"path":"/reference/createGDataMPP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create an object of class gDataMPP — createGDataMPP","text":"IBDprob object class IBDprob pheno data frame least columns \"genotype\" \"genotype\" one numerical columns containing phenotypic information. column \"cross\" can used indicating cross genotype comes . column ignored IBDprob attribute genoCross containing information (default behaviour).","code":""},{"path":"/reference/effectPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a matrix plot — effectPlot","title":"Create a matrix plot — effectPlot","text":"Create matrix plot effect sizes directions per parent significant snps.","code":""},{"path":"/reference/effectPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a matrix plot — effectPlot","text":"","code":"effectPlot(   effectDat,   signSnp,   map,   xLab = \"Chromosomes\",   yLab = \"Parents\",   chrBoundaries,   title = NULL,   trait = NULL,   ...,   output = TRUE )"},{"path":"/reference/kinshipIBD.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute kinship matrix for IBD probabilities — kinshipIBD","title":"Compute kinship matrix for IBD probabilities — kinshipIBD","text":"Compute kinship matrix list chromosome specific kinship matrices 3D array IBD probabilities. kinship matrix computed averaging \\(Z Z^t\\) markers, \\(Z\\) genotype x parents matrix marker. chrSpecific = TRUE chromosome specific kinship matrices computed chromosome based markers chromosomes.","code":""},{"path":"/reference/kinshipIBD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute kinship matrix for IBD probabilities — kinshipIBD","text":"","code":"kinshipIBD(markers, map = NULL, chrSpecific = TRUE)"},{"path":"/reference/kinshipIBD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute kinship matrix for IBD probabilities — kinshipIBD","text":"markers n x m x p array IBD probabilities genotypes rows (n), markers columns (m), parents 3rd dimension (p). map data.frame columns chr chromosome pos position. Positions centimorgan (cM). cumulative chromosomes. columns ignored. Marker names row names. match marker names input file. required chrSpecific = TRUE. chrSpecific chromomsome specific kinship matrices computed?","code":""},{"path":"/reference/kinshipIBD.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute kinship matrix for IBD probabilities — kinshipIBD","text":"kinship matrix list chromosome specific kinship matrices.","code":""},{"path":"/reference/maizeMQM.html","id":null,"dir":"Reference","previous_headings":"","what":"Pre-computed MQM output maize — maizeMQM","title":"Pre-computed MQM output maize — maizeMQM","text":"Pre-computed MQM output maize data used vignette.","code":""},{"path":"/reference/maizeMQM.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pre-computed MQM output maize — maizeMQM","text":"","code":"maizeMQM"},{"path":"/reference/maizeMQM.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Pre-computed MQM output maize — maizeMQM","text":"object class QTLMPP (inherits GWAS) length 5.","code":""},{"path":"/reference/maizeSQM.html","id":null,"dir":"Reference","previous_headings":"","what":"Pre-computed SQM output maize — maizeSQM","title":"Pre-computed SQM output maize — maizeSQM","text":"Pre-computed SQM output maize data used vignette.","code":""},{"path":"/reference/maizeSQM.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pre-computed SQM output maize — maizeSQM","text":"","code":"maizeSQM"},{"path":"/reference/maizeSQM.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Pre-computed SQM output maize — maizeSQM","text":"object class QTLMPP (inherits GWAS) length 5.","code":""},{"path":"/reference/plot.QTLMPP.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot function for the class QTLMPP — plot.QTLMPP","title":"Plot function for the class QTLMPP — plot.QTLMPP","text":"Creates plot object S3 class QTLMPP. following types plot can made: QTLProfile QTL profile plot, .e. plot \\(-log10(p)\\) values per marker. parEffs  plot effect sizes directions per parent. QTLRegion plot highlighting QTLs found genetic map. QTLProfileExt combination QTL profile parental effects plotted . See details detailed description plots plot options specific different plots.","code":""},{"path":"/reference/plot.QTLMPP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot function for the class QTLMPP — plot.QTLMPP","text":"","code":"# S3 method for QTLMPP plot(   x,   ...,   plotType = c(\"QTLProfile\", \"parEffs\", \"QTLRegion\", \"QTLProfileExt\"),   title = NULL,   output = TRUE )"},{"path":"/reference/plot.QTLMPP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot function for the class QTLMPP — plot.QTLMPP","text":"x object class QTLMPP. ... arguments passed actual plotting functions. plotType character string indicating type plot made. One \"QTLProfile\", \"parEffs\", \"QTLRegion\". title character string, title plot. output plot output current device? FALSE, ggplot object invisibly returned.","code":""},{"path":"/reference/plot.QTLMPP.html","id":"qtl-profile-plot","dir":"Reference","previous_headings":"","what":"QTL Profile plot","title":"Plot function for the class QTLMPP — plot.QTLMPP","text":"profile marker positions corresponding \\(-log10(p)\\) values plotted. QTLs found highlighted red dots. threshold plotted horizontal line. previously known marker effects, false positives true negatives can also marked. Extra parameter options: xLab character string, x-axis label. Default = \"Chromosomes\" yLab character string, y-axis label. Default = -log10(p) effects character vector, indicating markers correspond real (known) effect. Used determining true/false positives false negatives. True positives colored green, false positives orange false negatives yellow. colPalette color palette used plotting. Default coloring done chromosome, using black grey. signLwd numerical value giving thickness points false/true positives/negatives. Default = 0.6 chr vector chromosomes plotted. default, chromosomes plotted. Using option allows restricting plot subset chromosomes.","code":""},{"path":"/reference/plot.QTLMPP.html","id":"parental-effects-plot","dir":"Reference","previous_headings":"","what":"Parental effects Plot","title":"Plot function for the class QTLMPP — plot.QTLMPP","text":"plot effect sizes parents QTLs found created. Extra parameter options: xLab character string, x-axis label. Default = \"Chromosomes\" yLab character string, y-axis label. Default = \"Parents\" chr vector chromosomes plotted. default, chromosomes plotted. Using option allows restricting plot subset chromosomes.","code":""},{"path":"/reference/plot.QTLMPP.html","id":"qtl-region-plot","dir":"Reference","previous_headings":"","what":"QTL Region Plot","title":"Plot function for the class QTLMPP — plot.QTLMPP","text":"plot effect created positions QTLs found QTL detection highlighted red. extra parameter options.","code":""},{"path":"/reference/plot.QTLMPP.html","id":"extended-qtl-profile-plot","dir":"Reference","previous_headings":"","what":"Extended QTL Profile Plot","title":"Plot function for the class QTLMPP — plot.QTLMPP","text":"extended version QTL Profile Plot, QLT profile plot combined parental effect plot make easier assess effects specific QTL found. Extra parameter options: chr vector chromosomes plotted. default, chromosomes plotted. Using option allows restricting plot subset chromosomes.","code":""},{"path":"/reference/plot.QTLMPP.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot function for the class QTLMPP — plot.QTLMPP","text":"","code":"if (FALSE) { ## Read phenotypic data. pheno <- read.delim(system.file(\"extdata/multipop\", \"AxBxCpheno.txt\",                                package = \"statgenMPP\")) ## Rename first column to genotype. colnames(pheno)[1] <- \"genotype\"   ## Compute IBD probabilities for simulated population - AxB, AxC. ABC <- calcIBDMPP(crossNames = c(\"AxB\", \"AxC\"),                   markerFiles = c(system.file(\"extdata/multipop\", \"AxB.txt\",                                               package = \"statgenMPP\"),                                   system.file(\"extdata/multipop\", \"AxC.txt\",                                               package = \"statgenMPP\")),                   pheno = pheno,                   popType = \"F4DH\",                   mapFile = system.file(\"extdata/multipop\", \"mapfile.txt\",                                         package = \"statgenMPP\"),                   evalDist = 5)  ## Multi-QTL Mapping. ABC_MQM <- selQTLMPP(ABC, trait = \"yield\")  ## QTL Profile plot. plot(ABC_MQM, plotType = \"QTLProfile\")  ## Plot of parental effects for QTLs found. plot(ABC_MQM, plotType = \"parEffs\")  ## Plot of genetic map highlighting positions of QTLs found. plot(ABC_MQM, plotType = \"QTLRegion\")  ## Extended QTL Profile plot. plot(ABC_MQM, plotType = \"QTLProfileExt\") }"},{"path":"/reference/plot.gDataMpp.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot function for the class gDataMPP — plot.gDataMPP","title":"Plot function for the class gDataMPP — plot.gDataMPP","text":"Creates plot object S3 class gDataMPP. following types plot can made: genMap plot genetic map. allGeno plot showing genotypes IBD probabilities parent highest probability per marker. singleGeno plot single genotype showing IBD probabilities parents across genome. pedigree plot showing structure pedigree population. See respective sections details plots.","code":""},{"path":"/reference/plot.gDataMpp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot function for the class gDataMPP — plot.gDataMPP","text":"","code":"# S3 method for gDataMPP plot(   x,   ...,   plotType = c(\"genMap\", \"allGeno\", \"singleGeno\", \"pedigree\"),   genotype = NULL,   title = NULL,   output = TRUE )"},{"path":"/reference/plot.gDataMpp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot function for the class gDataMPP — plot.gDataMPP","text":"x object class gDataMPP. ... arguments passed actual plotting functions. plotType character string indicating type plot made. One \"genMap\", \"singleGeno\", \"allGeno\" \"pedigree\". genotype character string indicating genotype plot made. plotType = \"singleGeno\". title character string, title plot. output plot output current device? FALSE, ggplot object invisibly returned.","code":""},{"path":"/reference/plot.gDataMpp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot function for the class gDataMPP — plot.gDataMPP","text":"ggplot object invisibly returned.","code":""},{"path":"/reference/plot.gDataMpp.html","id":"genmap","dir":"Reference","previous_headings":"","what":"genMap","title":"Plot function for the class gDataMPP — plot.gDataMPP","text":"plot made showing lengths chromosomes position markers present map. possible highlight one markers using extra parameter highlight.","code":""},{"path":"/reference/plot.gDataMpp.html","id":"allgeno","dir":"Reference","previous_headings":"","what":"allGeno","title":"Plot function for the class gDataMPP — plot.gDataMPP","text":"plot made showing genotypes markers. combination genotype marker colored according parent highest probability. darker color indicates higher probability.","code":""},{"path":"/reference/plot.gDataMpp.html","id":"singlegeno","dir":"Reference","previous_headings":"","what":"singleGeno","title":"Plot function for the class gDataMPP — plot.gDataMPP","text":"plot made single genotype, specified genotpye = \"name_of_genotype\" showing IBD probabilities selected genotype parents across genome.","code":""},{"path":"/reference/plot.gDataMpp.html","id":"pedigree","dir":"Reference","previous_headings":"","what":"pedigree","title":"Plot function for the class gDataMPP — plot.gDataMPP","text":"plot made showing structure pedigree population gDataMPP object.","code":""},{"path":"/reference/plot.gDataMpp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot function for the class gDataMPP — plot.gDataMPP","text":"","code":"## Read phenotypic data. pheno <- read.delim(system.file(\"extdata/multipop\", \"AxBxCpheno.txt\",                                package = \"statgenMPP\")) ## Rename first column to genotype. colnames(pheno)[1] <- \"genotype\"   ## Compute IBD probabilities for simulated population - AxB, AxC. ABC <- calcIBDMPP(crossNames = c(\"AxB\", \"AxC\"),                   markerFiles = c(system.file(\"extdata/multipop\", \"AxB.txt\",                                               package = \"statgenMPP\"),                                   system.file(\"extdata/multipop\", \"AxC.txt\",                                               package = \"statgenMPP\")),                   pheno = pheno,                   popType = \"F4DH\",                   mapFile = system.file(\"extdata/multipop\", \"mapfile.txt\",                                         package = \"statgenMPP\"),                   evalDist = 5)  ## Plot the genetic map. plot(ABC, plotType = \"genMap\")   ## Plot the genetic map and highlight marker EXT_3_30. plot(ABC, plotType = \"genMap\", highlight = \"EXT_3_30\")   ## Plot the IBD probabilities across the genome for all genotypes. plot(ABC, plotType = \"allGeno\")   ## Plot the IBD probabilities for genotype AxB0001. plot(ABC, plotType = \"singleGeno\", genotype = \"AxB0001\")   ## Plot the pedigree. plot(ABC, plotType = \"pedigree\")"},{"path":"/reference/print.summary.QTLMPP.html","id":null,"dir":"Reference","previous_headings":"","what":"Print summary of object of class summary.QTLMPP — print.summary.QTLMPP","title":"Print summary of object of class summary.QTLMPP — print.summary.QTLMPP","text":"Print summary object class summary.QTLMPP","code":""},{"path":"/reference/print.summary.QTLMPP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print summary of object of class summary.QTLMPP — print.summary.QTLMPP","text":"","code":"# S3 method for summary.QTLMPP print(x, ...)"},{"path":"/reference/print.summary.QTLMPP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print summary of object of class summary.QTLMPP — print.summary.QTLMPP","text":"x object class summary.QTLMPP. ... used.","code":""},{"path":"/reference/randomQTLmodel.html","id":null,"dir":"Reference","previous_headings":"","what":"one position fitted in the mixed model — randomQTLmodel","title":"one position fitted in the mixed model — randomQTLmodel","text":"one position fitted mixed model","code":""},{"path":"/reference/randomQTLmodel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"one position fitted in the mixed model — randomQTLmodel","text":"","code":"randomQTLmodel(   modDat,   map,   parents,   trait = \"yield\",   scanMrk = NULL,   cofMrk = NULL,   NULLmodel = FALSE )"},{"path":"/reference/readRABBITMPP.html","id":null,"dir":"Reference","previous_headings":"","what":"Read IBD probabilities — readRABBITMPP","title":"Read IBD probabilities — readRABBITMPP","text":"Read file IBD probabilities computed RABBIT software package. possible additionally read pedigree file also used RABBIT. Reading file allows plotting pedigree. Phenotypic data can added data.frame.","code":""},{"path":"/reference/readRABBITMPP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read IBD probabilities — readRABBITMPP","text":"","code":"readRABBITMPP(infile, pedFile = NULL, pheno = NULL)"},{"path":"/reference/readRABBITMPP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read IBD probabilities — readRABBITMPP","text":"infile character string, link .csv file IBD probabilities. pedFile character string, link .csv file pedigree information used RABBIT input. pheno data frame least columns \"genotype\" \"genotype\" one numerical columns containing phenotypic information. column \"cross\" can used indicating cross genotype comes .","code":""},{"path":"/reference/readRABBITMPP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read IBD probabilities — readRABBITMPP","text":"gDataMPP object map markers corresponding imported information imported .csv file.","code":""},{"path":"/reference/readRABBITMPP.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Read IBD probabilities — readRABBITMPP","text":"Zheng, Chaozhi, Martin P Boer, Fred Van Eeuwijk. “Recursive Algorithms Modeling Genomic Ancestral Origins Fixed Pedigree.” G3 Genes|Genomes|Genetics 8 (10): 3231–45. https://doi.org/10.1534/G3.118.200340.","code":""},{"path":"/reference/readRABBITMPP.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Read IBD probabilities — readRABBITMPP","text":"","code":"## Read RABBIT data for barley. genoFile <- system.file(\"extdata/barley\", \"barley_magicReconstruct.zip\",                        package = \"statgenMPP\") barleyMPMPP <- readRABBITMPP(unzip(genoFile, exdir = tempdir()))"},{"path":"/reference/scanQTL.html","id":null,"dir":"Reference","previous_headings":"","what":"one-round genome scan with specified cofactor(s) — scanQTL","title":"one-round genome scan with specified cofactor(s) — scanQTL","text":"one-round genome scan specified cofactor(s)","code":""},{"path":"/reference/scanQTL.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"one-round genome scan with specified cofactor(s) — scanQTL","text":"","code":"scanQTL(   modDat,   map,   markers,   parents,   QTLwindow = 10,   cof = NULL,   Usc = NULL,   trait = NULL,   maxIter = 100,   parallel = FALSE,   verbose = FALSE )"},{"path":"/reference/selQTLMPP.html","id":null,"dir":"Reference","previous_headings":"","what":"Multi round genome scans for QTL detection — selQTLMPP","title":"Multi round genome scans for QTL detection — selQTLMPP","text":"Multi round genome scans QTL detection. Several rounds QTL detection performed. First model fitted without cofactors. least one marker \\(-log10(p)\\) value threshold marker lowest p-Value added cofactor next round QTL detection. process continues new markers \\(-log10(p)\\) value threshold maximum number cofactors reached.","code":""},{"path":"/reference/selQTLMPP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multi round genome scans for QTL detection — selQTLMPP","text":"","code":"selQTLMPP(   MPPobj,   trait = NULL,   QTLwindow = 10,   threshold = 3,   maxCofactors = NULL,   K = NULL,   computeKin = FALSE,   parallel = FALSE,   verbose = FALSE )"},{"path":"/reference/selQTLMPP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multi round genome scans for QTL detection — selQTLMPP","text":"MPPobj object class gDataMPP, typically output either calcIBDMPP readRABBITMPP. trait character string indicating trait QTL mapping done . QTLwindow numerical value indicating window around QTL considered part QTL. threshold numerical value indicating threshold \\(-log10p\\) value marker considered QTL. maxCofactors numerical value, maximum number cofactors include model. NULL cofactors added new cofactors found. K list chromosome specific kinship matrices. NULL computeKin = FALSE kinship matrix included models. computeKin chromosome specific kinship matrices computed? parallel computation variance components done parallel? requires parallel back-end registered. See examples. verbose progress intermediate plots output?","code":""},{"path":"/reference/selQTLMPP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multi round genome scans for QTL detection — selQTLMPP","text":"object class QTLMPP","code":""},{"path":"/reference/selQTLMPP.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Multi round genome scans for QTL detection — selQTLMPP","text":"default family specific effects residual variances kinship relations included model. possible include kinship relations either specifying computeKin = TRUE. kinship matrix computed averaging \\(Z Z^t\\) markers, \\(Z\\) genotype x parents matrix marker. also possible specify list precomputed chromosome specific kinship matrices K. Note adding kinship matrix model increases computation time lot, especially large populations.","code":""},{"path":[]},{"path":"/reference/selQTLMPP.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Multi round genome scans for QTL detection — selQTLMPP","text":"","code":"## Read phenotypic data. pheno <- read.delim(system.file(\"extdata/multipop\", \"AxBxCpheno.txt\",                                package = \"statgenMPP\")) ## Rename first column to genotype. colnames(pheno)[1] <- \"genotype\"   ## Compute IBD probabilities for simulated population - AxB, AxC. ABC <- calcIBDMPP(crossNames = c(\"AxB\", \"AxC\"),                   markerFiles = c(system.file(\"extdata/multipop\", \"AxB.txt\",                                               package = \"statgenMPP\"),                                   system.file(\"extdata/multipop\", \"AxC.txt\",                                               package = \"statgenMPP\")),                   pheno = pheno,                   popType = \"F4DH\",                   mapFile = system.file(\"extdata/multipop\", \"mapfile.txt\",                                         package = \"statgenMPP\"),                   evalDist = 5)  ## Single-QTL Mapping. ABC_SQM <- selQTLMPP(ABC, trait = \"yield\", maxCofactors = 0)  ## Multi-QTL Mapping. if (FALSE) { ## Register parallel back-end with 2 cores. doParallel::registerDoParallel(cores = 2)  ## Run multi-QTL mapping. ABC_MQM <- selQTLMPP(ABC, trait = \"yield\", parallel = TRUE)  ## Run multi-QTL mapping - include kinship matrix. ABC_MQM_kin <- selQTLMPP(ABC, trait = \"yield\", parallel = TRUE,                         computeKin = TRUE) }"},{"path":"/reference/statgenMPP-package.html","id":null,"dir":"Reference","previous_headings":"","what":"statgenMPP: QTL Mapping for Multi Parent Populations — statgenMPP-package","title":"statgenMPP: QTL Mapping for Multi Parent Populations — statgenMPP-package","text":"Multi Parent Populations (MPP) Identity Descend (IBD) probabilities computed using Hidden Markov Models. probabilities used mixed model approach QTL Mapping described Li et al. (doi:10.1007/s00122-021-03919-7 ).","code":""},{"path":"/reference/statgenMPP-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"statgenMPP: QTL Mapping for Multi Parent Populations — statgenMPP-package","text":"Maintainer: Bart-Jan van Rossum bart-jan.vanrossum@wur.nl (ORCID) Authors: Wenhao Li wenhao.li@wur.nl (ORCID) Martin Boer martin.boer@wur.nl (ORCID) contributors: Fred van Eeuwijk (ORCID) [contributor]","code":""},{"path":"/reference/summary.QTLMPP.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary function for the class QTLMPP — summary.QTLMPP","title":"Summary function for the class QTLMPP — summary.QTLMPP","text":"Gives summary object S3 class QTLMPP.","code":""},{"path":"/reference/summary.QTLMPP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary function for the class QTLMPP — summary.QTLMPP","text":"","code":"# S3 method for QTLMPP summary(object, ...)"},{"path":"/reference/summary.QTLMPP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary function for the class QTLMPP — summary.QTLMPP","text":"object object class QTLMPP. ... used.","code":""},{"path":"/reference/summary.QTLMPP.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summary function for the class QTLMPP — summary.QTLMPP","text":"","code":"if (FALSE) { ## Read phenotypic data. pheno <- read.delim(system.file(\"extdata/multipop\", \"AxBxCpheno.txt\",                                package = \"statgenMPP\")) ## Rename first column to genotype. colnames(pheno)[1] <- \"genotype\"  ## Compute IBD probabilities for simulated population - AxB, AxC. ABC <- calcIBDMPP(crossNames = c(\"AxB\", \"AxC\"),                   markerFiles = c(system.file(\"extdata/multipop\", \"AxB.txt\",                                               package = \"statgenMPP\"),                                   system.file(\"extdata/multipop\", \"AxC.txt\",                                               package = \"statgenMPP\")),                   pheno = pheno,                   popType = \"F4DH\",                   mapFile = system.file(\"extdata/multipop\", \"mapfile.txt\",                                         package = \"statgenMPP\"),                   evalDist = 5)  ## Multi-QTL Mapping. ABC_MQM <- selQTLMPP(ABC, trait = \"yield\")  ## Print summary. summary(ABC_MQM) }"},{"path":"/reference/summary.gDataMpp.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary function for the class gDataMPP — summary.gDataMPP","title":"Summary function for the class gDataMPP — summary.gDataMPP","text":"Gives summary object S3 class gDataMPP.","code":""},{"path":"/reference/summary.gDataMpp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary function for the class gDataMPP — summary.gDataMPP","text":"","code":"# S3 method for gDataMPP summary(object, ..., trials = NULL)"},{"path":"/reference/summary.gDataMpp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary function for the class gDataMPP — summary.gDataMPP","text":"object object class gDataMPP. ... used. trials vector trials include summary. can either numeric indices character names list items pheno. NULL, trials included.","code":""},{"path":"/reference/summary.gDataMpp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary function for the class gDataMPP — summary.gDataMPP","text":"list four components: mapSum list number markers number chromosomes map. markerSum list number markers, number genotypes distribution values within markers. phenoSum list data.frames, one per trial summary traits within trial. covarSum list data.frames, one per trial summary covariates within trial. components present output corresponding content present gDataMPP object.","code":""},{"path":"/news/index.html","id":"statgenmpp-101","dir":"Changelog","previous_headings":"","what":"statgenMPP 1.0.1","title":"statgenMPP 1.0.1","text":"logic scan process improved, leading much lower computation times. * Computations can now done parallel registering parallel back-end setting parallel = TRUE selQTLMPP function. now possible include polygenic effect models correct background genetic information. new function createGDataMPP added directly create gDataMPP object IBDprob object (created statgenIBD) data.frame phenotypic data. readRABBIT renamed readRABBITMPP prevent future conflicts similar function statgenIBD trait column example data renamed “pheno” “yield”.","code":""},{"path":"/news/index.html","id":"statgenmpp-100","dir":"Changelog","previous_headings":"","what":"statgenMPP 1.0.0","title":"statgenMPP 1.0.0","text":"CRAN release: 2022-03-21 Initial CRAN release","code":""}]
